2025-04-19 18:02:46,009 - BERT_FakeNews - INFO - Configuration des hyperparamètres:
2025-04-19 18:02:46,010 - BERT_FakeNews - INFO - {
  "MAX_LEN": 512,
  "BATCH_SIZE": 16,
  "EPOCHS": 3,
  "LEARNING_RATE": 3e-05,
  "RANDOM_SEED": 42,
  "MODEL_NAME": "bert-base-uncased",
  "OUTPUT_DIR": "./Modele/bert_fine_tuned/",
  "USE_MIXED_PRECISION": true
}
2025-04-19 18:02:46,116 - BERT_FakeNews - INFO - Utilisation de l'appareil: cuda
2025-04-19 18:02:46,117 - BERT_FakeNews - INFO - Chargement des données depuis data/Fake.csv et data/True.csv
2025-04-19 18:02:46,974 - BERT_FakeNews - INFO - Données fake news chargées: 23481 exemples
2025-04-19 18:02:47,740 - BERT_FakeNews - INFO - Données true news chargées: 21417 exemples
2025-04-19 18:02:47,748 - BERT_FakeNews - INFO - Total d'exemples: 44898
2025-04-19 18:02:47,749 - BERT_FakeNews - INFO - Distribution des labels: {1: 23481, 0: 21417}
2025-04-19 18:02:47,783 - BERT_FakeNews - INFO - Exemples d'entraînement: 35918
2025-04-19 18:02:47,783 - BERT_FakeNews - INFO - Exemples de validation: 8980
2025-04-19 18:02:47,783 - BERT_FakeNews - INFO - Chargement du tokenizer bert-base-uncased
2025-04-19 18:02:48,025 - BERT_FakeNews - INFO - Création des datasets
2025-04-19 18:02:48,026 - BERT_FakeNews - INFO - Création des dataloaders
2025-04-19 18:02:48,026 - BERT_FakeNews - INFO - Chargement du modèle bert-base-uncased
2025-04-19 18:02:48,965 - BERT_FakeNews - INFO - Initialisation de l'optimiseur
2025-04-19 18:02:48,967 - BERT_FakeNews - INFO - Mixed precision activée
2025-04-19 18:02:48,968 - BERT_FakeNews - INFO - Début de l'entraînement...
2025-04-19 18:02:48,969 - BERT_FakeNews - INFO - Début de l'epoch 1
2025-04-19 18:02:50,275 - BERT_FakeNews - INFO -   Batch 1/2245 - Loss: 0.8217 - Temps: 1.15s
2025-04-19 18:04:13,028 - BERT_FakeNews - INFO -   Batch 100/2245 - Loss: 0.0025 - Temps: 0.64s
2025-04-19 18:05:36,475 - BERT_FakeNews - INFO -   Batch 200/2245 - Loss: 0.0004 - Temps: 0.64s
2025-04-19 18:06:59,715 - BERT_FakeNews - INFO -   Batch 300/2245 - Loss: 0.0003 - Temps: 0.64s
2025-04-19 18:08:24,083 - BERT_FakeNews - INFO -   Batch 400/2245 - Loss: 0.0002 - Temps: 0.64s
2025-04-19 18:09:47,744 - BERT_FakeNews - INFO -   Batch 500/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:11:11,176 - BERT_FakeNews - INFO -   Batch 600/2245 - Loss: 0.0004 - Temps: 0.64s
2025-04-19 18:12:34,206 - BERT_FakeNews - INFO -   Batch 700/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:13:58,298 - BERT_FakeNews - INFO -   Batch 800/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:15:22,029 - BERT_FakeNews - INFO -   Batch 900/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:16:45,951 - BERT_FakeNews - INFO -   Batch 1000/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:18:09,201 - BERT_FakeNews - INFO -   Batch 1100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:19:32,582 - BERT_FakeNews - INFO -   Batch 1200/2245 - Loss: 0.0007 - Temps: 0.64s
2025-04-19 18:20:55,912 - BERT_FakeNews - INFO -   Batch 1300/2245 - Loss: 0.0002 - Temps: 0.64s
2025-04-19 18:22:18,894 - BERT_FakeNews - INFO -   Batch 1400/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:23:42,168 - BERT_FakeNews - INFO -   Batch 1500/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:25:05,303 - BERT_FakeNews - INFO -   Batch 1600/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:26:28,018 - BERT_FakeNews - INFO -   Batch 1700/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:27:52,478 - BERT_FakeNews - INFO -   Batch 1800/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:29:16,501 - BERT_FakeNews - INFO -   Batch 1900/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:30:39,660 - BERT_FakeNews - INFO -   Batch 2000/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:32:02,887 - BERT_FakeNews - INFO -   Batch 2100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:33:27,038 - BERT_FakeNews - INFO -   Batch 2200/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:34:04,327 - BERT_FakeNews - INFO - Fin de l'epoch 1 - Temps total: 1875.36s - Temps moyen par batch: 0.64s
2025-04-19 18:34:04,328 - BERT_FakeNews - INFO - Epoch 1/3 - Train loss: 0.0094
2025-04-19 18:34:04,329 - BERT_FakeNews - INFO - Début de l'évaluation (validation)
2025-04-19 18:42:11,225 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4283    1]
 [   3 4693]]
2025-04-19 18:42:11,225 - BERT_FakeNews - INFO - Évaluation terminée - Temps total: 486.90s
2025-04-19 18:42:11,225 - BERT_FakeNews - INFO - Accuracy (validation): 0.9996
2025-04-19 18:42:11,225 - BERT_FakeNews - INFO - Rapport de classification (validation):
              precision    recall  f1-score   support

           0       1.00      1.00      1.00      4284
           1       1.00      1.00      1.00      4696

    accuracy                           1.00      8980
   macro avg       1.00      1.00      1.00      8980
weighted avg       1.00      1.00      1.00      8980

2025-04-19 18:42:11,230 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4283    1]
 [   3 4693]]
2025-04-19 18:42:11,231 - BERT_FakeNews - INFO - Matrice de confusion validation sauvegardée à ./Modele/bert_fine_tuned/confusion_matrix_validation.txt
2025-04-19 18:42:11,232 - BERT_FakeNews - INFO - Début de l'epoch 2
2025-04-19 18:42:12,058 - BERT_FakeNews - INFO -   Batch 1/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:43:34,921 - BERT_FakeNews - INFO -   Batch 100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:44:58,731 - BERT_FakeNews - INFO -   Batch 200/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:46:21,788 - BERT_FakeNews - INFO -   Batch 300/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:47:44,959 - BERT_FakeNews - INFO -   Batch 400/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:49:08,477 - BERT_FakeNews - INFO -   Batch 500/2245 - Loss: 0.0003 - Temps: 0.64s
2025-04-19 18:50:32,273 - BERT_FakeNews - INFO -   Batch 600/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:51:55,567 - BERT_FakeNews - INFO -   Batch 700/2245 - Loss: 0.0004 - Temps: 0.64s
2025-04-19 18:53:19,666 - BERT_FakeNews - INFO -   Batch 800/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 18:54:43,480 - BERT_FakeNews - INFO -   Batch 900/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:56:06,892 - BERT_FakeNews - INFO -   Batch 1000/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:57:29,840 - BERT_FakeNews - INFO -   Batch 1100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 18:58:52,687 - BERT_FakeNews - INFO -   Batch 1200/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:00:17,127 - BERT_FakeNews - INFO -   Batch 1300/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:01:40,443 - BERT_FakeNews - INFO -   Batch 1400/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:03:04,126 - BERT_FakeNews - INFO -   Batch 1500/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:04:27,259 - BERT_FakeNews - INFO -   Batch 1600/2245 - Loss: 0.0012 - Temps: 0.64s
2025-04-19 19:05:50,421 - BERT_FakeNews - INFO -   Batch 1700/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:07:13,594 - BERT_FakeNews - INFO -   Batch 1800/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:08:36,989 - BERT_FakeNews - INFO -   Batch 1900/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:09:59,925 - BERT_FakeNews - INFO -   Batch 2000/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:11:23,631 - BERT_FakeNews - INFO -   Batch 2100/2245 - Loss: 0.0003 - Temps: 0.64s
2025-04-19 19:12:47,087 - BERT_FakeNews - INFO -   Batch 2200/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:13:25,071 - BERT_FakeNews - INFO - Fin de l'epoch 2 - Temps total: 1873.84s - Temps moyen par batch: 0.64s
2025-04-19 19:13:25,072 - BERT_FakeNews - INFO - Epoch 2/3 - Train loss: 0.0078
2025-04-19 19:13:25,074 - BERT_FakeNews - INFO - Début de l'évaluation (validation)
2025-04-19 19:21:30,687 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4284    0]
 [   3 4693]]
2025-04-19 19:21:30,688 - BERT_FakeNews - INFO - Évaluation terminée - Temps total: 485.61s
2025-04-19 19:21:30,688 - BERT_FakeNews - INFO - Accuracy (validation): 0.9997
2025-04-19 19:21:30,688 - BERT_FakeNews - INFO - Rapport de classification (validation):
              precision    recall  f1-score   support

           0       1.00      1.00      1.00      4284
           1       1.00      1.00      1.00      4696

    accuracy                           1.00      8980
   macro avg       1.00      1.00      1.00      8980
weighted avg       1.00      1.00      1.00      8980

2025-04-19 19:21:30,693 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4284    0]
 [   3 4693]]
2025-04-19 19:21:30,694 - BERT_FakeNews - INFO - Matrice de confusion validation sauvegardée à ./Modele/bert_fine_tuned/confusion_matrix_validation.txt
2025-04-19 19:21:30,695 - BERT_FakeNews - INFO - Début de l'epoch 3
2025-04-19 19:21:31,520 - BERT_FakeNews - INFO -   Batch 1/2245 - Loss: 0.0001 - Temps: 0.64s
2025-04-19 19:22:53,758 - BERT_FakeNews - INFO -   Batch 100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:24:16,939 - BERT_FakeNews - INFO -   Batch 200/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:25:40,102 - BERT_FakeNews - INFO -   Batch 300/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:27:03,132 - BERT_FakeNews - INFO -   Batch 400/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:28:26,291 - BERT_FakeNews - INFO -   Batch 500/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:29:49,368 - BERT_FakeNews - INFO -   Batch 600/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:31:12,965 - BERT_FakeNews - INFO -   Batch 700/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:32:36,148 - BERT_FakeNews - INFO -   Batch 800/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:33:59,550 - BERT_FakeNews - INFO -   Batch 900/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:35:23,128 - BERT_FakeNews - INFO -   Batch 1000/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:36:46,287 - BERT_FakeNews - INFO -   Batch 1100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:38:10,013 - BERT_FakeNews - INFO -   Batch 1200/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:39:33,617 - BERT_FakeNews - INFO -   Batch 1300/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:40:57,381 - BERT_FakeNews - INFO -   Batch 1400/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:42:21,673 - BERT_FakeNews - INFO -   Batch 1500/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:43:44,986 - BERT_FakeNews - INFO -   Batch 1600/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:45:08,711 - BERT_FakeNews - INFO -   Batch 1700/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:46:32,022 - BERT_FakeNews - INFO -   Batch 1800/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:47:54,314 - BERT_FakeNews - INFO -   Batch 1900/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:49:17,622 - BERT_FakeNews - INFO -   Batch 2000/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:50:41,088 - BERT_FakeNews - INFO -   Batch 2100/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:52:04,604 - BERT_FakeNews - INFO -   Batch 2200/2245 - Loss: 0.0000 - Temps: 0.64s
2025-04-19 19:52:42,561 - BERT_FakeNews - INFO - Fin de l'epoch 3 - Temps total: 1871.87s - Temps moyen par batch: 0.64s
2025-04-19 19:52:42,562 - BERT_FakeNews - INFO - Epoch 3/3 - Train loss: 0.0003
2025-04-19 19:52:42,564 - BERT_FakeNews - INFO - Début de l'évaluation (validation)
2025-04-19 20:00:48,036 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4284    0]
 [   4 4692]]
2025-04-19 20:00:48,037 - BERT_FakeNews - INFO - Évaluation terminée - Temps total: 485.47s
2025-04-19 20:00:48,037 - BERT_FakeNews - INFO - Accuracy (validation): 0.9996
2025-04-19 20:00:48,037 - BERT_FakeNews - INFO - Rapport de classification (validation):
              precision    recall  f1-score   support

           0       1.00      1.00      1.00      4284
           1       1.00      1.00      1.00      4696

    accuracy                           1.00      8980
   macro avg       1.00      1.00      1.00      8980
weighted avg       1.00      1.00      1.00      8980

2025-04-19 20:00:48,041 - BERT_FakeNews - INFO - Matrice de confusion (validation):
[[4284    0]
 [   4 4692]]
2025-04-19 20:00:48,042 - BERT_FakeNews - INFO - Matrice de confusion validation sauvegardée à ./Modele/bert_fine_tuned/confusion_matrix_validation.txt
2025-04-19 20:00:48,042 - BERT_FakeNews - INFO - Sauvegarde du modèle dans ./Modele/bert_fine_tuned/
2025-04-19 20:00:49,431 - BERT_FakeNews - INFO - Métriques sauvegardées dans ./Modele/bert_fine_tuned/metrics.json
2025-04-19 20:00:49,431 - BERT_FakeNews - INFO - Début des tests sur les datasets externes
2025-04-19 20:00:49,431 - BERT_FakeNews - INFO - Test sur Fake_Real dataset
2025-04-19 20:00:49,431 - BERT_FakeNews - INFO - Test sur fake_real (data/fake_or_real_news.csv)
2025-04-19 20:00:49,757 - BERT_FakeNews - INFO - Dataset chargé: 6335 exemples
2025-04-19 20:00:49,758 - BERT_FakeNews - INFO - Distribution des labels: {'REAL': 3171, 'FAKE': 3164}
2025-04-19 20:00:49,760 - BERT_FakeNews - INFO - Début de l'évaluation (test_fake_real)
2025-04-19 20:00:49,785 - BERT_FakeNews - ERROR - Erreur lors du test sur fake_real: new(): invalid data type 'str'
2025-04-19 20:00:49,786 - BERT_FakeNews - INFO - Test sur Fake_News dataset
2025-04-19 20:00:49,786 - BERT_FakeNews - INFO - Test sur fake_news (data/train.csv)
2025-04-19 20:00:50,835 - BERT_FakeNews - INFO - Dataset chargé: 20800 exemples
2025-04-19 20:00:50,836 - BERT_FakeNews - INFO - Distribution des labels: {1: 10413, 0: 10387}
2025-04-19 20:00:50,837 - BERT_FakeNews - INFO - Début de l'évaluation (test_fake_news)
2025-04-19 20:21:59,172 - BERT_FakeNews - INFO - Matrice de confusion (test_fake_news):
[[10287   100]
 [ 7533  2880]]
2025-04-19 20:21:59,172 - BERT_FakeNews - INFO - Évaluation terminée - Temps total: 1268.34s
2025-04-19 20:21:59,172 - BERT_FakeNews - INFO - Accuracy (test_fake_news): 0.6330
2025-04-19 20:21:59,172 - BERT_FakeNews - INFO - Rapport de classification (test_fake_news):
              precision    recall  f1-score   support

           0       0.58      0.99      0.73     10387
           1       0.97      0.28      0.43     10413

    accuracy                           0.63     20800
   macro avg       0.77      0.63      0.58     20800
weighted avg       0.77      0.63      0.58     20800

2025-04-19 20:21:59,182 - BERT_FakeNews - INFO - Matrice de confusion :
[[10287   100]
 [ 7533  2880]]
2025-04-19 20:21:59,183 - BERT_FakeNews - INFO - Matrice de confusion sauvegardée à ./Modele/bert_fine_tuned/confusion_matrix_fake_news.txt
2025-04-19 20:21:59,183 - BERT_FakeNews - INFO - Métriques sauvegardées dans ./Modele/bert_fine_tuned/test_metrics_fake_news.json
2025-04-19 20:21:59,203 - BERT_FakeNews - INFO - Script terminé avec succès
2025-04-19 20:21:59,204 - BERT_FakeNews - INFO - Journal complet disponible dans: logs/bert_fine_tuned_20250419_180246.log
